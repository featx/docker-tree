#!/bin/sh

# When not limiting the open file descritors limit, the memory consumption of
# slapd is absurdly high. See https://github.com/docker/docker/issues/8231
ulimit -n 8192


set -e

if [ ! -d $OLDAP_DATA/etc ]; then
    mv /tmp/* $OLDAP_DATA/
fi

chown -R $OLDAP_GROUP:$OLDAP_USER $OLDAP_HOME

chown -R $OLDAP_GROUP:$OLDAP_USER $OLDAP_DATA

exec "$@"
